# Test fixture to ensure detection rules work with YAML anchors
# This workflow intentionally contains an injection vulnerability
name: Anchors - With Vulnerability
on:
  pull_request_target:
  push:

jobs:
  base_job: &vulnerable_job
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      # This step contains an injection vulnerability
      - name: Run command with user input
        run: echo "Branch name is ${{ github.head_ref }}"

  # This job reuses the vulnerable configuration via anchor
  test_job: *vulnerable_job
